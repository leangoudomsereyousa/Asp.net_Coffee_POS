@model Coffee_POS.ViewModels.MenuViewModel
@{
    ViewData["Title"] = "Menu";
    Layout = "_Layout";
}

<section class="container my-5">
    <!-- TITLE -->
    <div class="text-center mb-5">
        <h2 class="fw-bold display-6">Our Menu</h2>
        <p class="text-muted">Freshly brewed. Crafted with care.</p>
    </div>

    <!-- TOP BAR: Search + Cart -->
    <div class="row align-items-center g-3 mb-4 justify-content-center">
        <div class="col-lg-6">
            <form asp-action="Index" method="get">
                <div class="input-group shadow-sm rounded-pill overflow-hidden">
                    <input type="search"
                           class="form-control border-0 px-4 py-3"
                           name="searchKey"
                           value="@Model.SearchKey"
                           placeholder="Search coffee, espresso, latte…" />
                    <button class="btn btn-dark px-4">
                        <i class="fa fa-search"></i>
                    </button>
                </div>
            </form>
        </div>

        @if (Model.CartCount > 0)
        {
            <div class="col-auto text-end">
                <a asp-controller="Cart"
                   asp-action="Index"
                   class="btn btn-dark rounded-pill px-4 py-2 shadow-sm">
                    <i class="fa fa-shopping-bag me-2"></i>
                    Cart (@Model.CartCount)
                </a>
            </div>
        }
    </div>

    <div class="row">
        <!-- SIDEBAR / CATEGORIES -->
        <div class="col-lg-3 mb-4">
            <div class="card border-0 shadow-sm rounded-4 p-4">
                <h6 class="fw-semibold mb-3 text-center">Categories</h6>
                <ul class="list-unstyled small d-flex flex-column gap-2 align-items-center">
                    <li>
                        <a asp-action="Index"
                           class="text-decoration-none fw-semibold text-dark">
                            All Categories
                        </a>
                    </li>
                    @foreach (var cat in Model.Categories)
                    {
                        <li>
                            <a asp-action="Index"
                               asp-route-categoryId="@cat.Id"
                               class="text-decoration-none text-muted hover-link">
                                @cat.Name
                            </a>
                        </li>
                    }
                </ul>
            </div>
        </div>

        <!-- PRODUCTS GRID -->
        <div class="col-lg-9">
            <div class="row g-4">
                @foreach (var item in Model.Products)
                {
                    <div class="col-6 col-md-4 col-xl-3">
                        <div class="card h-100 border-0 shadow-sm rounded-4 product-card">
                            <div class="position-relative">
                                <img src="~/productImages/@item.Image"
                                     class="card-img-top rounded-top-4" />
                                <span class="badge bg-dark position-absolute top-0 start-0 m-3 rounded-pill px-3">
                                    @item.Category?.Name
                                </span>
                            </div>
                            <div class="card-body d-flex flex-column text-center">
                                <h6 class="fw-semibold mb-2">@item.Name</h6>
                                <p class="text-muted small flex-grow-1">@item.Description</p>
                                <form asp-controller="Cart" asp-action="Add" method="post" class="mt-auto">
                                    <input type="hidden" name="productId" value="@item.Id" />
                                    <input type="hidden" name="qty" value="1" />
                                    <button class="btn btn-dark w-100 rounded-pill py-2">
                                        <i class="fa fa-plus me-1"></i> Add to Cart
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
</section>

<style>
    /* Grid / Card */
    .product-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border-radius: 16px;
        overflow: hidden;
    }

        .product-card:hover {
            transform: translateY(-6px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

    /* Image */
    .card-img-top {
        width: 100%;
        height: 200px;
        object-fit: cover;
        border-top-left-radius: 16px;
        border-top-right-radius: 16px;
    }

    /* Text */
    .card-body h6 {
        font-weight: 600;
        font-size: 1.1rem;
    }

    .card-body p {
        font-size: 0.875rem;
        color: #6c757d;
    }

    /* Links hover */
    .hover-link:hover {
        color: #343a40 !important;
        text-decoration: none;
        font-weight: 600;
    }

    /* Add to cart button */
    .btn-dark {
        border-radius: 50px;
        padding: 0.5rem 1.5rem;
    }

    /* Categories list */
    .list-unstyled li a {
        display: inline-block;
        padding: 0.25rem 0.5rem;
        transition: all 0.2s;
    }

        .list-unstyled li a:hover {
            color: #000 !important;
            font-weight: 600;
        }
</style>
